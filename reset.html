<form id="newPassForm">
<input type="password" id="newPass" placeholder="New Password" required>
<button>Update Password</button>
<div id="msg"></div>
</form>

<script>
const WEBAPP="https://script.google.com/macros/s/AKfycbxNvLwZx-OwJpTswHn0n49lm0mJmj4z03_c9GVzAmY7xYrwUGlvIUdqdADFQPaV0RFP/exec";
const params=new URLSearchParams(window.location.search);
const token=params.get("token");

document.getElementById("newPassForm").addEventListener("submit",async e=>{
 e.preventDefault();
 const res=await fetch(WEBAPP,{
   method:"POST",
   headers:{"Content-Type":"application/json"},
   body:JSON.stringify({
     action:"resetPassword",
     token:token,
     newPassword:newPass.value
   })
 });
 const data=await res.json();
 msg.textContent=data.message;
});
</script>
